<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<script src="js/jquery.min.js"></script>
<title>Random Selection</title>
<link rel="stylesheet" href="css/choose.css">
</head>
<body>
	<lable id="chooseTest">开始你的表演</lable>
	<select id="options">
	</select>
	<button id="startButton">Start!</button>
	<script>
		$(document).ready(function() {
		    $.ajax({
		        url: 'http://47.93.43.242:8080/random/choosePage/categories',
		        type: 'POST',
		        contentType: 'application/json',
		        data: JSON.stringify({ isApply: 0 }),
		        success: function(data) {
					console.log("API call successful. Data received:", data);
		            $('#options').empty();
					data.data.forEach(function(item) {
		                // 创建一个新的 option 元素
		                var option = $('<option></option>').val(item.id).text(item.categoryName);
		                // 将 option 元素添加到 select 元素中
		                $('#options').append(option);
		            });
		        }
		    });

			
			$('#startButton').click(function() {
			    const selectedOption = $('#options').find(":selected");
			    const selectedId = selectedOption.val();
			    
			    if (selectedId) {
			        $.ajax({
			            url: "http://47.93.43.242:8080/random/choosePage/startRandom/" + selectedId,
			            type: "POST",
			            contentType: "application/json; charset=utf-8",
			            success: function(response) {
							var str = removeFirstAndLastChar(JSON.stringify(response.data.optionName));
			                const button = document.getElementById('chooseTest');
			                button.textContent = str;
							$('#chooseTest').text(str);
			            }
			        });
			    } else {
			        console.error("No option selected");
			    }
			});
		});
		function removeFirstAndLastChar(str) {
		    if (str.length <= 2) {
		        return ''; // 如果字符串长度小于或等于2，则返回空字符串
		    }
		    return str.substring(1, str.length - 1);
		}
	</script>
</body>
</html>
